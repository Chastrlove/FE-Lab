<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Frame</title>
  <meta
          name="viewport"
          content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1"
  />
  <style>
    #animation {
      width: 30px;
      height: 30px;
      background: red;
      animation: myfirst 5s infinite;
    }
    @keyframes myfirst {
      from {
        width: 30px;
        height: 30px;
        border-radius: 0;
        background: red;
      }
      to {
        width: 300px;
        height: 300px;
        border-radius: 50%;
        background: yellow;
      }
    }
  </style>
</head>
<body>
<div id="animation">test</div>
</body>
<script>
  // function rafCallback(timestamp) {
  //   window.requestAnimationFrame(rafCallback);
  // }
  // window.requestAnimationFrame(rafCallback);

  // const now = performance.now()
  //
  // function timeoutCallback() {
  //   setTimeout(timeoutCallback, 0);
  // }
  // setTimeout(timeoutCallback, 0);
  //
  // const timeout = 1000;
  // requestIdleCallback(workLoop, { timeout });
  // function workLoop(deadline) {
  //   requestIdleCallback(workLoop, { timeout });
  //   const start = new Date().getTime();
  //   while (new Date().getTime() - start < 7) {}
  // }
  let prev = performance.now()
  const aa  = ()=>{
    const now = performance.now()
    console.log(now-prev)
    prev = now
  }
  var channel = new MessageChannel();
  var port = channel.port2;
  channel.port1.onmessage = work;
  let count = 0
  function work() {
    count++
    if(count ===100){
      return
    }
    aa()
    port.postMessage(null);
  }
  port.postMessage(null);
</script>
</html>
